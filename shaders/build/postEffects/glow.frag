#version 330

uniform sampler2D tex0;
uniform sampler2D tex1;
in vec2 fragTexCoord;
out vec4 outputColor;

uniform float sample = 2.0;
uniform float iterations = 8;
uniform float gaussian[100] = float[] (0.23696313590506837, 0.22576837913554718, 0.2149304965314546, 0.20444927242920974, 0.19432366696918377, 0.1845518595211794, 0.17513129301958733, 0.1660587189558863, 0.15733024278516244, 0.14894136951338266, 0.14088704924316767, 0.13316172246762595, 0.12575936491431866, 0.1186735317544968, 0.11189740100626834, 0.10542381597419066, 0.09924532658183352, 0.09335422946800571, 0.08774260673148353, 0.08240236322311853, 0.0773252622980482, 0.07250295995429872, 0.06792703729727498, 0.06358903128241358, 0.0594804637005589, 0.05559286838236543, 0.05191781660917574, 0.04844694072833519, 0.045171955980752694, 0.042084680557670666, 0.03917705391205346, 0.0364411533577275, 0.033869208996403666, 0.031453617018985, 0.029186951433115504, 0.027061974273770033, 0.025071644357838672, 0.023209124647140075, 0.0214677882871318, 0.01984122339079921, 0.018323236638827463, 0.016907855768226104, 0.015589331022117408, 0.014362135633453003, 0.013220965415025607, 0.012160737527331282, 0.011176588494649939, 0.010263871538186153, 0.009418153293284751, 0.008635209975644624, 0.007911023059133089, 0.007241774525289354, 0.006623841741928975, 0.006053792025457812, 0.005528376938598487, 0.005044526372259342, 0.004599342457255244, 0.004190093348552506, 0.003814206921672727, 0.00346926441787937, 0.0031529940717994523, 0.002863264752221866, 0.0025980796439755197, 0.0023555699960388587, 0.0021339889583780157, 0.0019317055274632945, 0.0017471986179802869, 0.0015790512759391155, 0.0014259450461971356, 0.0012866545053506402, 0.0011600419690211364, 0.0010450523807626958, 0.0009407083881481699, 0.0008461056100525355, 0.0007604080977391869, 0.0006828439910664701, 0.0006127013699641679, 0.0005493243002780956, 0.0004921090721417389, 0.0004405006282012008, 0.00039398917828905374, 0.00035210699650789463, 0.00031442539614041443, 0.0002805518773432896, 0.0002501274422019469, 0.00022282407141596062, 0.0001983423566452461, 0.00017640928236931793, 0.00015677615099052658, 0.00013921664484182239, 0.00012352501873527194, 0.00010951441670426968, 0.00009701530664553113, 0.000085874026652078, 0.00007595143694136696, 0.00006712167141956476, 0.00005927098308008699, 0.00005229667760850829, 0.00004610612975370932, 0.00004061587722377405);

void main() {

  vec2 tex_offset = sample / textureSize(tex1, 0);
  vec3 result = texture(tex0, fragTexCoord).rgb;
  result += texture(tex1, fragTexCoord).rgb * gaussian[0];
  for (int i = 1; i < iterations; ++i) {
    result += texture(tex1, fragTexCoord + vec2(tex_offset.x * i, 0.0)).rgb * gaussian[int((100*i)/iterations)]*sample;
    result += texture(tex1, fragTexCoord - vec2(tex_offset.x * i, 0.0)).rgb * gaussian[int((100*i)/iterations)]*sample;
  }
  for (int i = 1; i < iterations; ++i) {
    result += texture(tex1, fragTexCoord + vec2(0.0, tex_offset.y * i)).rgb * gaussian[int((100*i)/iterations)]*sample;
    result += texture(tex1, fragTexCoord - vec2(0.0, tex_offset.y * i)).rgb * gaussian[int((100*i)/iterations)]*sample;
  }
  outputColor = vec4(result, 1.0);
  
}
